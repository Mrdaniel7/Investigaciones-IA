<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>Destilaci칩n - Experimetos IA</title><meta name="description" content="游빍 Destilaci칩n de IA en Mac: De Tonto a Listo Documentaci칩n visual paso a paso del experimento 'Teacher-Student' en Apple Silicon. Vamos a&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="./destilacion.html"><link rel="stylesheet" href="./assets/css/fontawesome-all.min.css?v=85514f933f9e0b82460af63f1a403fa5"><link rel="stylesheet" href="./assets/css/style.css?v=6d92336350d5374cc2b2fb5720b76be5"><noscript><link rel="stylesheet" href="./assets/css/noscript.css?v=efa867a99f5064d6729e4dc2008ad50b"></noscript><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"./destilacion.html"},"headline":"Destilaci칩n","datePublished":"2026-02-14T09:20+01:00","dateModified":"2026-02-14T10:37+01:00","description":"游빍 Destilaci칩n de IA en Mac: De Tonto a Listo Documentaci칩n visual paso a paso del experimento 'Teacher-Student' en Apple Silicon. Vamos a&hellip;","author":{"@type":"Person","name":"Daniel Terroba Alcala","url":"./authors/daniel-terroba-alcala/"},"publisher":{"@type":"Organization","name":"Daniel Terroba Alcala"}}</script><style>#wrapper > .bg {
               background-image: url(./assets/images/overlay.png), linear-gradient(0deg, rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1)), url();
           }</style><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="is-preload page-template"><div id="wrapper"><header id="header"><a class="logo" href="./">Experimetos IA</a></header><nav id="nav"><ul class="links"><li><a href="./cuantizacion.html" target="_self">Cuantizacion</a></li><li><a href="./agente-opencode.html" target="_self">Agente</a></li><li><a href="./fine-tuning.html" target="_self">Fine Tuning</a></li><li><a href="./preentrenamiento.html" target="_self">Preentrenamiento</a></li><li class="active"><a href="./destilacion.html" target="_self">Destilaci칩n</a></li><li><a href="./crear-lm.html" target="_self">Crear un Llm</a></li></ul></nav><main id="main"><article class="post"><header class="major"><h1>Destilaci칩n</h1><p class="post__inner"></p></header><div class="post__inner post__entry"><div id="quant-guide-container"><h1 style="color: #58a6ff; font-size: 2em; margin-bottom: 10px;">游빍 Destilaci칩n de IA en Mac: De Tonto a Listo</h1><p></p><figure class="post__image"><img loading="lazy" src="./media/posts/5/portada.png" alt="" width="2816" height="1536" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/5/responsive/portada-xs.png 300w, ./media/posts/5/responsive/portada-sm.png 480w, ./media/posts/5/responsive/portada-md.png 768w, ./media/posts/5/responsive/portada-lg.png 1024w, ./media/posts/5/responsive/portada-xl.png 1360w, ./media/posts/5/responsive/portada-2xl.png 1600w"></figure><p></p><p>Documentaci칩n visual paso a paso del experimento "Teacher-Student" en <strong>Apple Silicon</strong>. Vamos a coger un modelo peque침o que no sabe ni por d칩nde le da el aire y lo vamos a entrenar con la sabidur칤a de un modelo m치s grande.</p><div class="note"><strong>El Objetivo:</strong> Tenemos un modelo "Profesor" (Qwen 2.5 7B) que es muy listo pero pesado. Tenemos un "Alumno" (Qwen 0.5B) que es r치pido pero un poco corto. La misi칩n es que el Profesor genere un "libro de texto" (dataset) para que el Alumno estudie y aprenda a resolver acertijos complejos.</div><div></div><div></div><div></div><div class="tabs"><div class="tab active" style="cursor: default;">Mac (Apple Silicon)</div></div><div id="mac-content" class="tab-content active"><h2>Fase 1: Preparando el Chiringuito</h2><p>Lo primero es lo primero: el orden. No queremos ensuciar nuestro Mac instalando librer칤as a lo loco en el sistema global. As칤 que vamos a crear una carpeta para el proyecto y, muy importante, un <strong>entorno virtual</strong>.</p><p>Esto es como crear una caja de arena donde podemos romper cosas sin miedo. Usaremos <code>mlx-lm</code>, que es la librer칤a m치gica de Apple para que sus chips M1/M2/M3 vuelen con la IA.</p><p></p><p></p><div class="code-wrapper"><div class="code-header">1.1 Comandos de la Terminal</div><pre><code># Creamos la carpeta del experimento
mkdir practica_destilacion
cd practica_destilacion

# Creamos el entorno virtual (esto es mano de santo para no liar dependencias)
python3 -m venv venv
source venv/bin/activate

# Instalamos las herramientas necesarias. MLX es la clave aqu칤.
pip install mlx-lm huggingface_hub</code></pre></div><figure><figure class="post__image"><img loading="lazy" src="./media/posts/5/1.jpeg" alt="" width="1599" height="899" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/5/responsive/1-xs.jpeg 300w, ./media/posts/5/responsive/1-sm.jpeg 480w, ./media/posts/5/responsive/1-md.jpeg 768w, ./media/posts/5/responsive/1-lg.jpeg 1024w, ./media/posts/5/responsive/1-xl.jpeg 1360w, ./media/posts/5/responsive/1-2xl.jpeg 1600w"></figure></figure><p></p><p></p><h2>Fase 2: El Profesor Prepara la Clase</h2><p>Para ense침ar, necesitamos material. No podemos esperar que el modelo peque침o aprenda de la nada. As칤 que he preparado una lista de acertijos con cierta "miga" po칠tica, de esos que requieren pensar un poco y no solo memorizar.</p><figure><figure class="post__image"><img loading="lazy" src="./media/posts/5/4.jpeg" alt="" width="1599" height="899" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/5/responsive/4-xs.jpeg 300w, ./media/posts/5/responsive/4-sm.jpeg 480w, ./media/posts/5/responsive/4-md.jpeg 768w, ./media/posts/5/responsive/4-lg.jpeg 1024w, ./media/posts/5/responsive/4-xl.jpeg 1360w, ./media/posts/5/responsive/4-2xl.jpeg 1600w"></figure></figure><p>Ahora entra en juego el script <code>generar_datos.py</code>. Este script hace lo siguiente: carga al "Profesor" (el modelo de 7 billones de par치metros) y le dice: <em>"Oye, resuelve estos acertijos uno por uno y expl칤came la respuesta paso a paso"</em>. Esas respuestas se guardan en un formato que luego podamos usar para entrenar (JSONL).</p><figure><figure class="post__image"><img loading="lazy" src="./media/posts/5/2-2.jpeg" alt="" width="1599" height="899" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/5/responsive/2-2-xs.jpeg 300w, ./media/posts/5/responsive/2-2-sm.jpeg 480w, ./media/posts/5/responsive/2-2-md.jpeg 768w, ./media/posts/5/responsive/2-2-lg.jpeg 1024w, ./media/posts/5/responsive/2-2-xl.jpeg 1360w, ./media/posts/5/responsive/2-2-2xl.jpeg 1600w"></figure></figure><h3>춰A Generar!</h3><p>Lanzamos el script. Ver치s que primero se descargan los pesos del modelo si no los tienes. MLX hace esto muy f치cil, conect치ndose directamente a HuggingFace.</p><figure><figure class="post__image"><img loading="lazy" src="./media/posts/5/3.jpeg" alt="" width="1599" height="899" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/5/responsive/3-xs.jpeg 300w, ./media/posts/5/responsive/3-sm.jpeg 480w, ./media/posts/5/responsive/3-md.jpeg 768w, ./media/posts/5/responsive/3-lg.jpeg 1024w, ./media/posts/5/responsive/3-xl.jpeg 1360w, ./media/posts/5/responsive/3-2xl.jpeg 1600w"></figure></figure><p></p><p>Aqu칤 vemos c칩mo se carga el modelo en la memoria RAM unificada del Mac. Es un modelo 4-bit cuantizado, as칤 que es eficiente pero mantiene la inteligencia.</p><figure><figure class="post__image"><img loading="lazy" src="./media/posts/5/5.jpeg" alt="" width="1599" height="899" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/5/responsive/5-xs.jpeg 300w, ./media/posts/5/responsive/5-sm.jpeg 480w, ./media/posts/5/responsive/5-md.jpeg 768w, ./media/posts/5/responsive/5-lg.jpeg 1024w, ./media/posts/5/responsive/5-xl.jpeg 1360w, ./media/posts/5/responsive/5-2xl.jpeg 1600w"></figure></figure><p></p><p></p><p>Y empieza la fiesta. El profesor va leyendo cada pregunta y generando la "soluci칩n maestra". Esto es lo que usaremos de verdad (Ground Truth) para entrenar al peque침o.</p><figure><figure class="post__image"><img loading="lazy" src="./media/posts/5/6.jpeg" alt="" width="1599" height="899" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/5/responsive/6-xs.jpeg 300w, ./media/posts/5/responsive/6-sm.jpeg 480w, ./media/posts/5/responsive/6-md.jpeg 768w, ./media/posts/5/responsive/6-lg.jpeg 1024w, ./media/posts/5/responsive/6-xl.jpeg 1360w, ./media/posts/5/responsive/6-2xl.jpeg 1600w"></figure></figure><p></p><h2>Fase 3: El Entrenamiento (Destilaci칩n)</h2><p>Ya tenemos el libro de texto (<code>train.jsonl</code>). Ahora toca meter al alumno en la biblioteca y cerrar la puerta. Vamos a usar <strong>LoRA (Low-Rank Adaptation)</strong>.</p><p>Explicaci칩n r치pida: En lugar de reentrenar todo el cerebro del modelo (que ser칤a lent칤simo y car칤simo), le a침adimos unas "capas extra" (adaptadores) y solo entrenamos eso. Es como ponerle gafas a alguien para que vea mejor, en lugar de operarle los ojos.</p><p></p><div class="code-wrapper"><div class="code-header">3.1 El Comando M치gico</div><pre><code># Usamos el script de LoRA que viene con MLX
python -m mlx_lm.lora \
  --model Qwen/Qwen2.5-0.5B \   # El modelo Alumno (peque침o)
  --train --data ./ \           # D칩nde est치n los datos
  --iters 200 \                 # N칰mero de iteraciones (repasos)
  --batch-size 4 \              # Cu치ntos ejemplos ve a la vez
  --adapter-path adapters       # D칩nde guardar lo aprendido</code></pre></div><figure><figure class="post__image"><img loading="lazy" src="./media/posts/5/7.jpeg" alt="" width="1599" height="899" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/5/responsive/7-xs.jpeg 300w, ./media/posts/5/responsive/7-sm.jpeg 480w, ./media/posts/5/responsive/7-md.jpeg 768w, ./media/posts/5/responsive/7-lg.jpeg 1024w, ./media/posts/5/responsive/7-xl.jpeg 1360w, ./media/posts/5/responsive/7-2xl.jpeg 1600w"></figure></figure><p></p><p>Despu칠s de unos minutos (es super r치pido en Mac), vemos los resultados. La p칠rdida ha bajado a <strong>0.312</strong>. 춰Eso es una barbaridad! Significa que el modelo ha empezado a entender patrones y a replicar el razonamiento del profesor.</p><figure><figure class="post__image"><img loading="lazy" src="./media/posts/5/8.jpeg" alt="" width="1599" height="899" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/5/responsive/8-xs.jpeg 300w, ./media/posts/5/responsive/8-sm.jpeg 480w, ./media/posts/5/responsive/8-md.jpeg 768w, ./media/posts/5/responsive/8-lg.jpeg 1024w, ./media/posts/5/responsive/8-xl.jpeg 1360w, ./media/posts/5/responsive/8-2xl.jpeg 1600w"></figure></figure><p></p><h2>Fase 4: La Prueba del Algod칩n</h2><p>Vale, los n칰meros dicen que ha aprendido, pero vamos a verlo en acci칩n. Compar칠 al modelo tal cual viene de f치brica (Base) contra nuestro modelo "dopado" con LoRA (Destilado).</p><p>Le hice la pregunta: <em>"Si me nombras, desaparezco. 쯈ui칠n soy?"</em></p><ul><li><strong>El modelo Base:</strong> Empez칩 a alucinar c칩digo inform치tico y repetir <code>.userInteractionEnabled</code> como un disco rayado. Un desastre.</li><li><strong>El modelo Destilado:</strong> Respondi칩 directo y al grano: <strong>"El Viento"</strong> (bueno, t칠cnicamente es el silencio, pero el razonamiento fue v치lido y coherente).</li></ul><figure><figure class="post__image"><img loading="lazy" src="./media/posts/5/9.jpeg" alt="" width="1599" height="899" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/5/responsive/9-xs.jpeg 300w, ./media/posts/5/responsive/9-sm.jpeg 480w, ./media/posts/5/responsive/9-md.jpeg 768w, ./media/posts/5/responsive/9-lg.jpeg 1024w, ./media/posts/5/responsive/9-xl.jpeg 1360w, ./media/posts/5/responsive/9-2xl.jpeg 1600w"></figure></figure><p>Para no ir mirando una a una, me hice un script "Tutor" que valida autom치ticamente las respuestas. Aqu칤 vemos c칩mo el alumno va respondiendo y el script le da el visto bueno.</p><figure><figure class="post__image"><img loading="lazy" src="./media/posts/5/10.jpeg" alt="" width="1599" height="899" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/5/responsive/10-xs.jpeg 300w, ./media/posts/5/responsive/10-sm.jpeg 480w, ./media/posts/5/responsive/10-md.jpeg 768w, ./media/posts/5/responsive/10-lg.jpeg 1024w, ./media/posts/5/responsive/10-xl.jpeg 1360w, ./media/posts/5/responsive/10-2xl.jpeg 1600w"></figure></figure><p></p><h2>Fase 5: El Examen Final y las "Alucinaciones"</h2><p>No nos enga침emos, es un modelo de 0.5B par치metros, es diminuto. Hice un examen final con preguntas nuevas que no hab칤a visto antes. 쮼l resultado?</p><p>Pas칩 de un <strong>36%</strong> de acierto (base) a un <strong>50%</strong> (destilado). Es una mejora brutal para tan poco tiempo de entrenamiento.</p><p><strong>Lo m치s divertido:</strong> Todav칤a tiene momentos de creatividad "excesiva". A la pregunta <em>"Dos pinzas tengo, hacia atr치s camino, de mar o de r칤o..."</em> (Un cangrejo), el t칤o me respondi칩 muy convencido: <strong>"Una zapatilla de golf"</strong>. 游뱎</p><figure><figure class="post__image"><img loading="lazy" src="./media/posts/5/11.jpeg" alt="" width="1599" height="899" sizes="(max-width: 48em) 100vw, 768px" srcset="./media/posts/5/responsive/11-xs.jpeg 300w, ./media/posts/5/responsive/11-sm.jpeg 480w, ./media/posts/5/responsive/11-md.jpeg 768w, ./media/posts/5/responsive/11-lg.jpeg 1024w, ./media/posts/5/responsive/11-xl.jpeg 1360w, ./media/posts/5/responsive/11-2xl.jpeg 1600w"></figure></figure></div><h2>游늵 La Gr치fica de la Verdad</h2><p>Aqu칤 se ve claro. El modelo base apenas acierta por casualidad. El profesor es perfecto (obviamente). Y nuestro peque침o alumno, despu칠s de estudiar, se ha puesto a medio camino. Nada mal para ser 14 veces m치s peque침o que su maestro.</p><div class="chart-box"><canvas id="comparisonChart"></canvas></div><script src="https://cdn.jsdelivr.net/npm/chart.js"></script><script>// Cargar Gr치fica Comparativa
        window.addEventListener('load', function() {
            if (typeof Chart !== 'undefined') {
                const ctx = document.getElementById('comparisonChart').getContext('2d');
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Alumno Base (0.5B)', 'Alumno Destilado (0.5B)', 'Profesor (7B)'],
                        datasets: [{
                            label: 'Tasa de Acierto (%)',
                            data: [36, 50, 100], 
                            backgroundColor: [
                                'rgba(255, 99, 132, 0.6)',  // Rojo
                                'rgba(75, 192, 192, 0.6)',  // Verde
                                'rgba(54, 162, 235, 0.6)'   // Azul
                            ],
                            borderColor: [
                                'rgba(255, 99, 132, 1)',
                                'rgba(75, 192, 192, 1)',
                                'rgba(54, 162, 235, 1)'
                            ],
                            borderWidth: 2,
                            borderRadius: 5
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return context.parsed.y + '% de Aciertos';
                                    }
                                }
                            }
                        },
                        scales: {
                            y: { 
                                beginAtZero: true, 
                                max: 100,
                                grid: { color: '#30363d', borderDash: [5, 5] }, 
                                ticks: { color: '#8b949e', font: {family: 'monospace'} },
                                title: { display: true, text: 'Precisi칩n', color: '#8b949e'}
                            },
                            x: { 
                                ticks: { color: '#c9d1d9', font: {weight: 'bold'} },
                                grid: { display: false }
                            }
                        }
                    }
                });
            } else {
                document.querySelector('.chart-box').innerHTML = '<p style="color:red; text-align:center;">Chart.js no se ha cargado.</p>';
            }
        });</script></div></div></article></main><footer id="copyright"><p>Hecho por Daniel Terroba Alcal치</p></footer></div><script src="./assets/js/jquery.min.js?v=c9771cc3e90e18f5336eedbd0fffb2cf"></script><script src="./assets/js/jquery.scrollex.min.js?v=f89065e3d988006af9791b44561d7c90"></script><script src="./assets/js/jquery.scrolly.min.js?v=1ed5a78bde1476875a40f6b9ff44fc14"></script><script src="./assets/js/browser.min.js?v=c07298dd19048a8a69ad97e754dfe8d0"></script><script src="./assets/js/breakpoints.min.js?v=81a479eb099e3b187613943b085923b8"></script><script src="./assets/js/util.min.js?v=4201a626f8c9b614a663b3a1d7d82615"></script><script src="./assets/js/main.min.js?v=56233c354bd814758be8bff42f7e13a5"></script><script>/*<![CDATA[*/var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};/*]]>*/</script></body></html>